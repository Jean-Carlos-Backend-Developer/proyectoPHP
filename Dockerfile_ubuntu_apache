# Imagen base: Ubuntu 24.04 (Noble Numbat)
FROM ubuntu:24.04
# Evitar preguntas interactivas de apt
ENV DEBIAN_FRONTEND=noninteractive
# Instalar Apache y PHP con el módulo necesario
RUN apt update && \
apt install -y apache2 php libapache2-mod-php && \
apt clean && rm -rf /var/lib/apt/lists/*
# Detectar automáticamente el módulo PHP instalado y activarlo
RUN set -e; \
PHP_MOD=$(ls /usr/lib/apache2/modules | grep -o 'libphp[0-9.]*\.so' | sed 's/libphp\(.*\)\.so/php\1/'); \
if [ -n "$PHP_MOD" ]; then \
echo "Activando módulo: $PHP_MOD"; \
a2enmod "$PHP_MOD"; \
else \
echo "No se encontró módulo PHP, revisa la instalación."; \
fi
# Asegurar que Apache use index.php como archivo por defecto
RUN sed -i 's/DirectoryIndex .*/DirectoryIndex index.php index.html/' /etc/apache2/mods-enabled/dir.conf
# Eliminar la página de bienvenida de Apache
RUN rm -f /var/www/html/index.html
# Copiar tu página personalizada
COPY src/ /var/www/html/
# Opcional: cambiar propietario para que Apache tenga permisos
RUN chown -R www-data:www-data /var/www/html
# Exponer el puerto 80
EXPOSE 80
# Comando por defecto: ejecutar Apache en primer plano
CMD ["apache2ctl", "-D", "FOREGROUND"]